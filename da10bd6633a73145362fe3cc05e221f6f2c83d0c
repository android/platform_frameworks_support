{
  "comments": [
    {
      "key": {
        "uuid": "9de204d7_250fc115",
        "filename": "room/common/src/main/java/androidx/room/Database.java",
        "patchSetId": 9
      },
      "lineNbr": 75,
      "author": {
        "id": 1060337
      },
      "writtenOn": "2018-09-04T19:44:47Z",
      "side": 1,
      "message": "view in the database",
      "range": {
        "startLine": 74,
        "startChar": 84,
        "endLine": 75,
        "endChar": 22
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6db6c1b5_90c0e081",
        "filename": "room/common/src/main/java/androidx/room/Database.java",
        "patchSetId": 9
      },
      "lineNbr": 75,
      "author": {
        "id": 1051900
      },
      "writtenOn": "2018-09-10T06:21:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9de204d7_250fc115",
      "range": {
        "startLine": 74,
        "startChar": 84,
        "endLine": 75,
        "endChar": 22
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "25fef473_d8cd795d",
        "filename": "room/common/src/main/java/androidx/room/DatabaseView.java",
        "patchSetId": 9
      },
      "lineNbr": 44,
      "author": {
        "id": 1060337
      },
      "writtenOn": "2018-09-04T19:44:47Z",
      "side": 1,
      "message": "via",
      "range": {
        "startLine": 44,
        "startChar": 49,
        "endLine": 44,
        "endChar": 51
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c199d2e4_76b54fb2",
        "filename": "room/common/src/main/java/androidx/room/DatabaseView.java",
        "patchSetId": 9
      },
      "lineNbr": 44,
      "author": {
        "id": 1051900
      },
      "writtenOn": "2018-09-10T06:21:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "25fef473_d8cd795d",
      "range": {
        "startLine": 44,
        "startChar": 49,
        "endLine": 44,
        "endChar": 51
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ce0176f6_db6288cb",
        "filename": "room/common/src/main/java/androidx/room/DatabaseView.java",
        "patchSetId": 9
      },
      "lineNbr": 45,
      "author": {
        "id": 1060337
      },
      "writtenOn": "2018-09-04T19:44:47Z",
      "side": 1,
      "message": "sqlite",
      "range": {
        "startLine": 45,
        "startChar": 20,
        "endLine": 45,
        "endChar": 28
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eb90e222_071368dd",
        "filename": "room/common/src/main/java/androidx/room/DatabaseView.java",
        "patchSetId": 9
      },
      "lineNbr": 45,
      "author": {
        "id": 1051900
      },
      "writtenOn": "2018-09-10T06:21:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ce0176f6_db6288cb",
      "range": {
        "startLine": 45,
        "startChar": 20,
        "endLine": 45,
        "endChar": 28
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e4eafff9_f3ac1ea3",
        "filename": "room/common/src/main/java/androidx/room/DatabaseView.java",
        "patchSetId": 9
      },
      "lineNbr": 46,
      "author": {
        "id": 1060337
      },
      "writtenOn": "2018-09-04T19:44:47Z",
      "side": 1,
      "message": "lets move this to another paragraph and say sth like:\n\n\"Room automatically handles View migrations, you don\u0027t need to write migrations for them except for dropped views\" (or are we handling view drops migrations?)",
      "range": {
        "startLine": 46,
        "startChar": 12,
        "endLine": 46,
        "endChar": 39
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c7422c16_aa062c91",
        "filename": "room/common/src/main/java/androidx/room/DatabaseView.java",
        "patchSetId": 9
      },
      "lineNbr": 46,
      "author": {
        "id": 1051900
      },
      "writtenOn": "2018-09-10T06:21:20Z",
      "side": 1,
      "message": "Done.\nYes, they are automatically dropped.",
      "parentUuid": "e4eafff9_f3ac1ea3",
      "range": {
        "startLine": 46,
        "startChar": 12,
        "endLine": 46,
        "endChar": 39
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b3a756ff_1fb256bc",
        "filename": "room/compiler/src/main/kotlin/androidx/room/processor/DatabaseProcessor.kt",
        "patchSetId": 9
      },
      "lineNbr": 86,
      "author": {
        "id": 1060337
      },
      "writtenOn": "2018-09-04T19:44:47Z",
      "side": 1,
      "message": "this is repeated 7 lines above. just create a local variable instead.",
      "range": {
        "startLine": 86,
        "startChar": 8,
        "endLine": 86,
        "endChar": 44
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e58a5eaa_e4688045",
        "filename": "room/compiler/src/main/kotlin/androidx/room/processor/DatabaseProcessor.kt",
        "patchSetId": 9
      },
      "lineNbr": 86,
      "author": {
        "id": 1051900
      },
      "writtenOn": "2018-09-10T06:21:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b3a756ff_1fb256bc",
      "range": {
        "startLine": 86,
        "startChar": 8,
        "endLine": 86,
        "endChar": 44
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "51e2e2cb_19ea9687",
        "filename": "room/compiler/src/main/kotlin/androidx/room/processor/DatabaseProcessor.kt",
        "patchSetId": 9
      },
      "lineNbr": 315,
      "author": {
        "id": 1060337
      },
      "writtenOn": "2018-09-04T19:44:47Z",
      "side": 1,
      "message": "there is no point in having this as a set since the isTable method traverses them all.\neither make this a list or change the isTable to  `!viewNames.contains(it.toLowercase(Locale.US))` and also keep lowercase names in views.\n\nI don\u0027t think any of it matters in terms of perf since there won\u0027t be hundreds of views so maybe just keep viewNames as a list.",
      "range": {
        "startLine": 315,
        "startChar": 8,
        "endLine": 315,
        "endChar": 61
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "69658b5a_41326e04",
        "filename": "room/compiler/src/main/kotlin/androidx/room/processor/DatabaseProcessor.kt",
        "patchSetId": 9
      },
      "lineNbr": 315,
      "author": {
        "id": 1051900
      },
      "writtenOn": "2018-09-10T06:21:20Z",
      "side": 1,
      "message": "Done. This is now a list.",
      "parentUuid": "51e2e2cb_19ea9687",
      "range": {
        "startLine": 315,
        "startChar": 8,
        "endLine": 315,
        "endChar": 61
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "becf834c_bba2c2a3",
        "filename": "room/compiler/src/main/kotlin/androidx/room/processor/DatabaseProcessor.kt",
        "patchSetId": 9
      },
      "lineNbr": 340,
      "author": {
        "id": 1060337
      },
      "writtenOn": "2018-09-04T19:44:47Z",
      "side": 1,
      "message": "having steps to resolve in a DatabaseView class seems really weird, where is it used ?\n\nupdate:\n\nso looks like we are doing this to re-order for creation. why don\u0027t we just keep views sorted in the database processor instead and avoid a confusing parameter ?",
      "range": {
        "startLine": 340,
        "startChar": 29,
        "endLine": 340,
        "endChar": 43
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3740082e_6aed5ef4",
        "filename": "room/compiler/src/main/kotlin/androidx/room/processor/DatabaseProcessor.kt",
        "patchSetId": 9
      },
      "lineNbr": 340,
      "author": {
        "id": 1051900
      },
      "writtenOn": "2018-09-10T06:21:20Z",
      "side": 1,
      "message": "Done. This is now sorted in processor.\n\nI think I subconsciously did it this way because all the other lists passed from the processor are treated like sets, and I was not sure if I could rely on the order in the list.",
      "parentUuid": "becf834c_bba2c2a3",
      "range": {
        "startLine": 340,
        "startChar": 29,
        "endLine": 340,
        "endChar": 43
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "724a87f3_005096c0",
        "filename": "room/runtime/src/main/java/androidx/room/util/DBUtil.java",
        "patchSetId": 9
      },
      "lineNbr": 101,
      "author": {
        "id": 1060337
      },
      "writtenOn": "2018-09-04T19:44:47Z",
      "side": 1,
      "message": "you cannot do this. developer might have their own views (the same way we allow their own tables).\n\n\nan option is to somehow mark the table as created by room (maybe some watermark in the query ?). that way we can know whether we can delete it or not.",
      "range": {
        "startLine": 100,
        "startChar": 19,
        "endLine": 101,
        "endChar": 59
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ba36c86c_dd69ae6f",
        "filename": "room/runtime/src/main/java/androidx/room/util/DBUtil.java",
        "patchSetId": 9
      },
      "lineNbr": 101,
      "author": {
        "id": 1051900
      },
      "writtenOn": "2018-09-10T06:21:20Z",
      "side": 1,
      "message": "Hmm, I disregarded developer-custom views as they can\u0027t be verified and few people should be using them, but yeah, people can still use it, so we should take it into consideration.\n\nI can\u0027t find a way to put any watermark in CREATE VIEW (https://www.sqlite.org/lang_createview.html). Can I create another table like room_master_table?\nCREATE TABLE room_view_table (name TEXT PRIMARY KEY, sql TEXT NOT NULL);",
      "parentUuid": "724a87f3_005096c0",
      "range": {
        "startLine": 100,
        "startChar": 19,
        "endLine": 101,
        "endChar": 59
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d9f9a531_70b758ba",
        "filename": "room/runtime/src/main/java/androidx/room/util/DBUtil.java",
        "patchSetId": 9
      },
      "lineNbr": 101,
      "author": {
        "id": 1060337
      },
      "writtenOn": "2018-09-10T19:46:22Z",
      "side": 1,
      "message": "people are already using custom views. Having this code will break their code when they update room version.\nI think the long term solution for this problem is for room to keep its own metadata tables for everything it generates (not just for views but all tables etc).\n\nI also couldn\u0027t find a way to watermark queries :/\n\nI think there are two options:\na) implement the metadata log first (i assume it to take time since it needs to be thoguthful) and then make this rely on that\n\nb) change this CL not to drop any views and instead update views if we try to create a view w/ the same name. And for dropped / renamed views, ask developer to add the migration. It is not a great story but would unblock this CL.\n\nI\u0027m open to suggestions.",
      "parentUuid": "ba36c86c_dd69ae6f",
      "range": {
        "startLine": 100,
        "startChar": 19,
        "endLine": 101,
        "endChar": 59
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2cf45481_39dc588e",
        "filename": "room/runtime/src/main/java/androidx/room/util/DBUtil.java",
        "patchSetId": 9
      },
      "lineNbr": 101,
      "author": {
        "id": 1051900
      },
      "writtenOn": "2018-09-11T05:28:14Z",
      "side": 1,
      "message": "b) sounds tempting, but the disparity between view creation and removal might be a headache in the future. Also, it feels strange to bump up the DB version and add a migration just to remove a view when it does not affect the schema.\n\nAbout a), what are the necessary information for tables? For now, it seems we can get enough information from default SQLite metadata. Are we going to provide some feature that require additional information?",
      "parentUuid": "d9f9a531_70b758ba",
      "range": {
        "startLine": 100,
        "startChar": 19,
        "endLine": 101,
        "endChar": 59
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bf7fade9_845f94c0",
        "filename": "room/runtime/src/main/java/androidx/room/util/DBUtil.java",
        "patchSetId": 9
      },
      "lineNbr": 101,
      "author": {
        "id": 1258207
      },
      "writtenOn": "2018-09-12T18:01:17Z",
      "side": 1,
      "message": "For option a. (Room metadata log) we do have plans on trying to provide a better migration story that would use a Room generated schema log / table so that we can basically handle the migration for the user all they would need to tell us is what they want to change between versions (addColumn, createTable, renameTable, etc...) and since we have a log of schema changes we would know how to apply those migration operations. In the case of views, we would be able to nicely keep track of Room created views and we would be able to clean them up.\n\nI suggest for now to go with option b. but instead of syncing views when the DB is opened to sync them when the DB is upgraded, making views be considered a schema change.",
      "parentUuid": "2cf45481_39dc588e",
      "range": {
        "startLine": 100,
        "startChar": 19,
        "endLine": 101,
        "endChar": 59
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ceb4a0dd_0470c8ce",
        "filename": "room/runtime/src/main/java/androidx/room/util/DBUtil.java",
        "patchSetId": 9
      },
      "lineNbr": 101,
      "author": {
        "id": 1051900
      },
      "writtenOn": "2018-09-13T02:27:52Z",
      "side": 1,
      "message": "I see. So we are improving the overall migration. Then it makes sense to put the views in schema. It makes @DatabaseView more consistent with @Entity while keeping the easy way of migration.\nI\u0027ll implement that way.",
      "parentUuid": "bf7fade9_845f94c0",
      "range": {
        "startLine": 100,
        "startChar": 19,
        "endLine": 101,
        "endChar": 59
      },
      "revId": "da10bd6633a73145362fe3cc05e221f6f2c83d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}