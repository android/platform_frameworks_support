{
  "comments": [
    {
      "key": {
        "uuid": "54b36f2e_3309412a",
        "filename": "benchmark/gradle-plugin/src/main/kotlin/androidx/benchmark/gradle/BenchmarkPlugin.kt",
        "patchSetId": 3
      },
      "lineNbr": 68,
      "author": {
        "id": 1060337
      },
      "writtenOn": "2019-06-06T22:24:31Z",
      "side": 1,
      "message": "it is actually a bad idea to call whenTaskAdded because it will break lazy configuration.\n\nhttps://docs.gradle.org/current/userguide/task_configuration_avoidance.html\n\n\nInstead of: TaskCollection.whenTaskAdded(org.gradle.api.Action)\nUse: DomainObjectCollection.configureEach(org.gradle.api.Action)\n\n\nI\u0027m not sure if that verison will help.\nAlso, you are probably better off using `named` (https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/TaskCollection.html#named-java.lang.String-) if you know the target task name.\notherwise, this is being called multiple times.",
      "range": {
        "startLine": 68,
        "startChar": 22,
        "endLine": 68,
        "endChar": 35
      },
      "revId": "723f262ddface571a342eb756e3f2a04529d5a0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58b37e8d_b082cf39",
        "filename": "benchmark/gradle-plugin/src/main/kotlin/androidx/benchmark/gradle/BenchmarkPlugin.kt",
        "patchSetId": 3
      },
      "lineNbr": 68,
      "author": {
        "id": 1458882
      },
      "writtenOn": "2019-06-06T22:35:53Z",
      "side": 1,
      "message": "Good idea about trying configureEach - I haven\u0027t tried that yet.\n\nOne thing about targeting cAT or cC directly is that when these tasks are added, it\u0027s too late to set the instrumentation argument.\n\nSo for example,\n\ntasks.whenTaskAdded {\n  if (task.name.contains(Regex(\"connected.*AndroidTest\")) {\n    ..testInstrumentationRunnerArgument(...)\n  }\n}\n\n...doesn\u0027t work.\n\nBut it turns out running androidTest in studio directly doesn\u0027t trigger whenTaskAdded for whatever reason.\n\nSo I think named will only work if we can figure out what the task is that parses / populates the instrumentation arguments.",
      "parentUuid": "54b36f2e_3309412a",
      "range": {
        "startLine": 68,
        "startChar": 22,
        "endLine": 68,
        "endChar": 35
      },
      "revId": "723f262ddface571a342eb756e3f2a04529d5a0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ca616fba_6dcae388",
        "filename": "benchmark/gradle-plugin/src/main/kotlin/androidx/benchmark/gradle/BenchmarkPlugin.kt",
        "patchSetId": 3
      },
      "lineNbr": 68,
      "author": {
        "id": 1458882
      },
      "writtenOn": "2019-06-07T01:00:31Z",
      "side": 1,
      "message": "So unfortunately, configureEach doesn\u0027t work as it is also called in time when running androidTest directly in Studio.\n\nWe need one of two things:\n\n1. A way to only add this argument when running tests from command line (otherwise it generate reports on device that never get deleted and subsequent runs in command line will pull tons of random files that were generated by running in Studio).\n\nOR\n\n2. A way to copy the benchmark report from device onto host when running directly in Studio (then we can just always turn on output).",
      "parentUuid": "58b37e8d_b082cf39",
      "range": {
        "startLine": 68,
        "startChar": 22,
        "endLine": 68,
        "endChar": 35
      },
      "revId": "723f262ddface571a342eb756e3f2a04529d5a0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "69a2379f_fda100c3",
        "filename": "benchmark/gradle-plugin/src/main/kotlin/androidx/benchmark/gradle/BenchmarkPlugin.kt",
        "patchSetId": 3
      },
      "lineNbr": 68,
      "author": {
        "id": 1458882
      },
      "writtenOn": "2019-06-07T02:15:15Z",
      "side": 1,
      "message": "Alright - so I switched it over to configureEach using the `android.injected.invoked.from.ide` flag since the plugin does not seem to get re-applied when there are no changes.",
      "parentUuid": "ca616fba_6dcae388",
      "range": {
        "startLine": 68,
        "startChar": 22,
        "endLine": 68,
        "endChar": 35
      },
      "revId": "723f262ddface571a342eb756e3f2a04529d5a0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}