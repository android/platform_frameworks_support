{
  "comments": [
    {
      "key": {
        "uuid": "5a58f1cc_67609a40",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 146,
      "author": {
        "id": 1020538
      },
      "writtenOn": "2019-01-31T02:05:59Z",
      "side": 1,
      "message": "Can you update generatef.py to support commenting code?\n\n// COMMENT_FOR_FRAMEWORK_FRAGMENT_START\ngetFragmentManager().beginTransaction()\n                .setPrimaryNavigationFragment(this)\n// COMMENT_FOR_FRAMEWORK_FRAGMENT_END",
      "range": {
        "startLine": 146,
        "startChar": 8,
        "endLine": 146,
        "endChar": 47
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "716e5fe6_61d145cb",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 146,
      "author": {
        "id": 1173368
      },
      "writtenOn": "2019-02-04T17:25:48Z",
      "side": 1,
      "message": "Hey Dake, I am not sure what you mean. Looking at generatef.py, this looks to back port changes to keep BrowseSupportFragment and BrowseFragment in sync. I added a comment to describe what this is doing and since it is only used in one place, do we need to update the python script?",
      "parentUuid": "5a58f1cc_67609a40",
      "range": {
        "startLine": 146,
        "startChar": 8,
        "endLine": 146,
        "endChar": 47
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a8caee25_a276be86",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 146,
      "author": {
        "id": 1020538
      },
      "writtenOn": "2019-02-04T19:55:12Z",
      "side": 1,
      "message": "update the python script, run the python script to update BrowseFragment.java.",
      "parentUuid": "716e5fe6_61d145cb",
      "range": {
        "startLine": 146,
        "startChar": 8,
        "endLine": 146,
        "endChar": 47
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3fb06e3c_5e329207",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 148,
      "author": {
        "id": 1020538
      },
      "writtenOn": "2019-01-30T22:42:21Z",
      "side": 1,
      "message": "this should be done when the fragment is added, such as the activity.",
      "range": {
        "startLine": 146,
        "startChar": 8,
        "endLine": 148,
        "endChar": 26
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fec05351_0987722f",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 148,
      "author": {
        "id": 1060451
      },
      "writtenOn": "2019-01-31T00:03:55Z",
      "side": 1,
      "message": "onAttach() is the callback for when the Fragment is added to the activity. This approach is the same approach used by Navigation, so this seems the appropriate place.",
      "parentUuid": "3fb06e3c_5e329207",
      "range": {
        "startLine": 146,
        "startChar": 8,
        "endLine": 148,
        "endChar": 26
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "eb241290_1f403705",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 148,
      "author": {
        "id": 1020538
      },
      "writtenOn": "2019-01-31T02:05:59Z",
      "side": 1,
      "message": "Ben, can you describe a concrete example how is this used?  Putting BrowseFragment in another fragment?",
      "parentUuid": "fec05351_0987722f",
      "range": {
        "startLine": 146,
        "startChar": 8,
        "endLine": 148,
        "endChar": 26
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "80617cf2_b7bdb46b",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 148,
      "author": {
        "id": 1020538
      },
      "writtenOn": "2019-01-31T19:19:26Z",
      "side": 1,
      "message": "nonetheless, you will have to make it optional, because this is an incompatible change, it breaks this use case: if the app is \"activty.getSupportFragmentManager().beginTransaction().add(popupFragment).addToBackStack()\" in BrowseSupportFragment.onClick(item),  the backkey will be incorrectly sent to BrowseSupportFragment instead of closing the popupFragment.\n\nIt\u0027s counter-intuitive to have BrowseSupportFragment itself to decide what to do,  a natural way would be the caller (aka activity) code setPrimaryNavigationFragment() when adding BrowseFragment,  BrowseFragment can check \"this \u003d\u003d getFragmentManager().getPrimaryNavigationFragment()\" (not 100% sure if this will work as the getPrimaryNavigationFragment() may not return the fragment before FragmentTransaction is actually done)",
      "parentUuid": "eb241290_1f403705",
      "range": {
        "startLine": 146,
        "startChar": 8,
        "endLine": 148,
        "endChar": 26
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ac0c2ca0_24cd41cc",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 148,
      "author": {
        "id": 1173368
      },
      "writtenOn": "2019-02-04T17:25:48Z",
      "side": 1,
      "message": "If the popup fragment is the last one on the backstack, why would it not get the back press event first?\n\nI tested this out with an error fragment in the sample and it works fine. I was using the navigation arch component though which manages the back stack for me. \n\nAm I understanding this correctly? If the caller called setPrimaryNavigationFragment, then we could choose fragment manager (main or child) to use in BrowseSupportFragment. This would be a preferred solution?",
      "parentUuid": "80617cf2_b7bdb46b",
      "range": {
        "startLine": 146,
        "startChar": 8,
        "endLine": 148,
        "endChar": 26
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "40b4dd88_78a21757",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 148,
      "author": {
        "id": 1020538
      },
      "writtenOn": "2019-02-04T19:55:12Z",
      "side": 1,
      "message": "The popup fragment is the last one on the backstack of activity, not the last one on backstack of primary fragment\u0027s childfragmentmanager. If the BrowseFragment is currently the primarynavigation fragment of activity, the backkey will be first routed to BrowseFragment to collapse the header\n\n\u003e\u003e \"I was using the navigation arch component though which manages the back stack for me.\"\nDeveloper write some code long time ago which is not using navigation arch, he updated supportlib, suddenly the code is broken and he is not aware of. This is incompatible library change.",
      "parentUuid": "ac0c2ca0_24cd41cc",
      "range": {
        "startLine": 146,
        "startChar": 8,
        "endLine": 148,
        "endChar": 26
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3efd67eb_7b8d5b11",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 156,
      "author": {
        "id": 1020538
      },
      "writtenOn": "2019-01-31T02:05:59Z",
      "side": 1,
      "message": "getFragmentManagerForBackStack()\n\nfinal getFragmentManagerForBackStack() {\n   // COMMENT_FOR_FRAMEWORK_FRAGMENT_START\n   return getChildFragmentManager();\n   // COMMENT_FOR_FRAMEWORK_FRAGMENT_END\n   // UNCOMMENT_FOR_FRAMEWORK_FRAGMENT_START\n   // return getFragmentManager();\n   // UNCOMMENT_FOR_FRAMEWORK_FRAGMENT_END\n}",
      "range": {
        "startLine": 156,
        "startChar": 30,
        "endLine": 156,
        "endChar": 53
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5bd728fe_716b56a5",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 166,
      "author": {
        "id": 1020538
      },
      "writtenOn": "2019-01-30T22:42:21Z",
      "side": 1,
      "message": "This will break something, we intentionally not using child fragment manager.  Maybe related with using xml to inflate a fragment. But I dont remember exactly.",
      "range": {
        "startLine": 166,
        "startChar": 23,
        "endLine": 166,
        "endChar": 28
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d768154f_5aeb4839",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 166,
      "author": {
        "id": 1020538
      },
      "writtenOn": "2019-01-30T22:49:19Z",
      "side": 1,
      "message": "shot in dark\n@adamp, do you remember the childFragmentManager vs FragmentManager issue?",
      "parentUuid": "5bd728fe_716b56a5",
      "range": {
        "startLine": 166,
        "startChar": 23,
        "endLine": 166,
        "endChar": 28
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b9941040_3034ce81",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 166,
      "author": {
        "id": 1020538
      },
      "writtenOn": "2019-01-30T22:56:54Z",
      "side": 1,
      "message": "So because of setPrimaryNavigationFragment(),  the backstack can now be nested with two level fragmentmanager?",
      "parentUuid": "d768154f_5aeb4839",
      "range": {
        "startLine": 166,
        "startChar": 23,
        "endLine": 166,
        "endChar": 28
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58f85f69_fdff5fb2",
        "filename": "leanback/src/main/java/androidx/leanback/app/BrowseSupportFragment.java",
        "patchSetId": 2
      },
      "lineNbr": 166,
      "author": {
        "id": 1060451
      },
      "writtenOn": "2019-01-31T00:03:55Z",
      "side": 1,
      "message": "That\u0027s correct - since you\u0027ve called setPrimaryNavigationFragment(), the back button events are sent to the child FragmentManager.",
      "parentUuid": "b9941040_3034ce81",
      "range": {
        "startLine": 166,
        "startChar": 23,
        "endLine": 166,
        "endChar": 28
      },
      "revId": "46e1ba333e3f477592fe3e8466bce65ea9fafc74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}